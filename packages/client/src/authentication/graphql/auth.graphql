fragment AuthChallenge on AuthChallengeResult {
  id
  text
}

query AuthChallenge($request: ChallengeRequest!) {
  result: challenge(request: $request) {
    ...AuthChallenge
  }
}

query AuthVerify($request: VerifyRequest!) {
  result: verify(request: $request)
}

fragment ApprovedAuthentication on ApprovedAuthentication {
  authorizationId
  browser
  device
  os
  origin
  expiresAt
  createdAt
  updatedAt
}

query ApprovedAuthentications($request: ApprovedAuthenticationRequest!) {
  result: approvedAuthentications(request: $request) {
    items {
      ...ApprovedAuthentication
    }
    pageInfo {
      ...PaginatedResultInfo
    }
  }
}

mutation AuthAuthenticate($request: SignedAuthChallenge!) {
  result: authenticate(request: $request) {
    accessToken
    refreshToken
  }
}

mutation AuthRefresh($request: RefreshRequest!) {
  result: refresh(request: $request) {
    accessToken
    refreshToken
  }
}

mutation RevokeAuthentication($request: RevokeAuthenticationRequest!) {
  revokeAuthentication(request: $request)
}
